<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"    content="width=device-width">
    <meta name="author"      content="M A Eyler, Istanbul, 2020" />
    <meta name="description" content="Reader for the Quran" />
    <!-- <link rel="stylesheet" href="code/main.css" media="all">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="image/icon.png"> -->
    <title>Iqra Introduction</title>
  <style>
    body {
      margin: 0;
    }
    iframe {
      display: none;
      position: absolute;
      box-sizing: border-box;
    }
  </style>
  </head>
  <body>

<iframe id=findFrm name=finder>
</iframe>
<iframe id=readFrm src='reader.html' name=iqra>
</iframe>

<script src=""></script>
<script>
function makeButton(frm, id, val, callback) {
  let b = document.createElement('button')
  b.id = id; b.innerText = val
  b.style="position:fixed; background:pink; top:0; right:0;"
  b.onclick = callback
  frm.contentDocument.body.appendChild(b)
  frm.contentWindow.addEventListener('hashchange', reportHash)
  return b
}
function addButtons() {
  openM = makeButton(readFrm, 'openM', 'M', showFinder)
  hideFinder()
}
function reportHash(e) {
  // console.log(e.newURL, e.target.document.title)
  document.title = e.target.document.title
  let b = findFrm.contentDocument.querySelector('#closeM')
  if (closeM != b) //make closer button
    closeM = makeButton(findFrm, 'closeM', 'x', hideFinder)
}
function hideFinder() {
  closeM.hidden=true; openM.hidden=false
  document.title = readFrm.contentDocument.title
  resize()
}
function showFinder() {
  closeM.hidden=false; openM.hidden=true
  if (findFrm.src) 
    document.title = findFrm.contentDocument.title
  else findFrm.src = 'mujam.html'
  resize()
}
function resize() {
    const WIDTH = 520, BORDER = 4
    const isNarrow = () => W <= 850
    const margin = (w) => Math.trunc((W-w-BORDER)/2)
    let W = window.innerWidth - BORDER
    let H = window.innerHeight - BORDER
    let w1, w2, x1, x2
    if (closeM.hidden) { //hideFinder
      findFrm.style.display = 'none'
      readFrm.style.display = 'inline-block'
      let k = (isNarrow()? 1 : 2)
      w1 = 0; w2 = Math.min(k*WIDTH, W)
      x1 = 0; x2 = margin(w2)
    } else { //showFinder
      findFrm.style.display = 'inline-block'
      if (isNarrow()) { //single column
        readFrm.style.display = 'none'
        w1 = Math.min(WIDTH, W); w2 = 0
      } else { //two columns
        readFrm.style.display = 'inline-block'
        w1 = Math.min(WIDTH, Math.trunc(W/2))
        w2 = w1
      }
      x1 = margin(w1+w2); x2 = x1 + BORDER + w1
    }
    findFrm.style.left = x1+"px"
    findFrm.style.width = w1+"px"
    readFrm.style.left = x2+"px"
    readFrm.style.width = w2+"px"
    findFrm.height = H
    readFrm.height = H
    // console.log('resize', W, H)
}
  const VERSION = '4a2'
  var openM, closeM = {hidden:1}  //switching buttons
  setTimeout(addButtons, 500)
  document.title = 'Iqra '+VERSION
  window.name = 'iqra'+VERSION
  window.onresize = resize
  // resize()  called in addButtons
</script>
    
  </body>
</html>
